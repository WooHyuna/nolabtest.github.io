{% assign emptyarray = "" | split: "," %}
{% assign data = site.data[include.data]
  | default: site[include.data]
  | default: emptyarray
  | data_filter: include.filter
%}

<!-- ðŸ”¹ ì—°êµ¬ì‹¤ ë…¼ë¬¸ ì—°ë„ë³„ ì •ë¦¬ -->
{% assign years = data | group_by_exp: "d", "d.date | date: '%Y'" | sort: "name" | reverse %}

{% for year in years %}
  {% assign data = year.items %}
  
  <h3 id="{{ year.name }}">{{ year.name }}</h3>
  {% assign data = data | sort: "date" | reverse %}

  {% for d in data %}
    {% assign style = d.style | default: include.style %}

    {%
      include {{ include.component | append: ".html" }}
      affiliation=d.affiliation
      author=d.author
      authors=d.authors
      buttons=d.buttons
      caption=d.caption
      content=d.content
      date=d.date
      description=d.description
      excerpt=d.excerpt
      height=d.height
      icon=d.icon
      id=d.id
      image=d.image
      last_modified_at=d.last_modified_at
      link=d.link
      lookup=d.lookup
      name=d.name
      publisher=d.publisher
      repo=d.repo
      role=d.role
      slug=d.slug
      style=style
      subtitle=d.subtitle
      tags=d.tags
      text=d.text
      title=d.title
      tooltip=d.tooltip
      type=d.type
      url=d.url
      width=d.width
    %}
  {% endfor %}
{% endfor %}

<!-- ðŸ”¹ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ì—°ë„ë³„ ì •ë¦¬ -->
{% assign blog_years = site.posts | group_by_exp: "post", "post.date | date: '%Y'" | sort: "name" | reverse %}

{% for year in blog_years %}
  <h3 id="blog-{{ year.name }}">{{ year.name }}</h3>

  {% assign posts = year.items | sort: "date" | reverse %}
  
  {% for post in posts %}
    <article class="blog-post">
      <h2><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h2>
      <p>{{ post.excerpt }}</p>

      <!-- ðŸ”¹ ìž‘ì„±ìž & ë‚ ì§œ -->
      {% if post.author %}
        <p><strong>By:</strong> {{ post.author }}</p>
      {% endif %}
      <p><strong>Date:</strong> {{ post.date | date: "%B %d, %Y" }}</p>

      <!-- ðŸ”¹ ê°¤ëŸ¬ë¦¬ ì¶”ê°€ -->
      {% if post.images %}
        <div class="post-gallery">
          {% assign images = post.images | split: ", " %}
          {% for img in images limit: 3 %}
            <img src="{{ img | relative_url }}" alt="Gallery Image">
          {% endfor %}
        </div>
      {% endif %}

      <a href="{{ post.url | relative_url }}">Read more...</a>
    </article>
  {% endfor %}
{% endfor %}
